# 自动化控制脚本使用指南

## 脚本概述

本仓库包含两个自动化控制脚本，分别用于前台和后台的游戏自动化操作：

1. `AutoGameController_Foreground.py` - 前台自动化控制
2. `AutoGameController_Background.py` - 后台自动化控制

## 前台脚本：AutoGameController_Foreground

### 功能说明
- 在前台自动执行鼠标点击和键盘操作
- 操作时窗口需要处于激活状态
- 适合不需要后台运行的操作场景

### 使用步骤

1. **环境准备**
   ```bash
   pip install pyautogui pywin32
   ```

2. **运行脚本**
   ```bash
   python AutoGameController_Foreground.py
   ```

3. **位置校准**
   - 按照提示"请将鼠标移动到目标位置，5秒后获取坐标..."
   - 5秒内将鼠标移动到目标位置
   - 脚本会自动记录坐标

4. **参数确认**
   - 查看校准后的坐标值
   - 确认操作流程和参数配置
   - 等待5秒后脚本自动开始执行

5. **停止脚本**
   - 按 `Ctrl+C` 安全停止
   - 控制台将显示"脚本已安全停止"

### 注意事项
⚠️ 窗口需要保持在前台可见  
⚠️ 操作期间避免移动鼠标  
⚠️ 确保游戏窗口位置不变  

---

## 后台脚本：AutoGameController_Background

### 功能说明
- 在后台自动执行鼠标点击和键盘操作
- 窗口最小化或后台运行
- 完全不影响用户在前台的工作

### 使用步骤

1. **环境准备**
   ```bash
   pip install pyautogui pywin32
   ```

2. **配置窗口标题**
   - 编辑脚本修改 `WINDOW_TITLE` 变量（例如"QQTPVE"）
   - 设置为游戏窗口标题的子字符串，程序自动进行匹配

3. **运行脚本**
   ```bash
   python AutoGameController_Background.py
   ```

4. **位置校准**
   - 按照提示"请将鼠标移动到目标位置，5秒后获取坐标..."
   - 5秒内将鼠标移动到目标位置
   - 脚本会计算相对坐标

5. **参数确认**
   - 检查窗口位置和客户区大小
   - 确认相对坐标在有效范围内
   - 等待5秒后脚本自动开始执行

6. **停止脚本**
   - 按 `Ctrl+C` 安全停止
   - 控制台将显示"脚本已安全停止"

### 注意事项
⚠️ 校准坐标时窗口不能最小化  
⚠️ 窗口大小改变后需要重新校准  
⚠️ 窗口请保持在后台最小化  

---

## 使用建议

### 脚本选择指南

| 使用场景 | 推荐脚本 |
|---------|----------|
| 需要后台操作不影响工作 | 后台脚本 |
| 简单自动化任务 | 前台脚本 |

### 常见问题排查

❓ **位置不准**
- 重新校准位置
- 确保窗口大小/位置与校准时一致
- 检查后台脚本的相对坐标是否在客户区内

❓ **操作未执行**
- 检查是否以管理员权限运行
- 验证窗口标题配置
- 尝试增加操作延迟时间

❓ **后台输入无效**
1. 关闭游戏的全屏独占模式
2. 切换到窗口化模式
3. 如仍无效则改用前台脚本

### 高级配置

1. **参数调整**
   - 修改脚本顶部的配置区
   - 可调整：
     - `CLICK_DELAY`: 点击延迟
     - `KEY_PRESS_TIME`: 按键时长
     - `LOOP_INTERVAL`: 循环间隔

2. **自定义操作**
   ```python
   def perform_actions():
       # 添加/修改操作步骤
       mouse_click(x, y)
       key_press('A')
       time.sleep(1)
   ```

3. **多位置支持**
   - 扩展校准步骤记录多个坐标
   - 在操作函数中使用不同坐标组合

---

## 贡献与支持

如有问题或建议，请提交Issue。欢迎贡献代码改进！

**温馨提示**：请合理使用自动化脚本，遵守游戏规则和服务条款。
